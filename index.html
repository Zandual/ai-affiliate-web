<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

    <!--
      IMPORTANT RULES (Cloudflare Pages + your app bundle)
      ----------------------------------------------------
      1) Keep <div id="root"></div> (React mounts here).
      2) Keep BOTH bundle scripts:
         - index.<hash>.js  (main web bundle)
         - AppEntry-<hash>.js (Expo entry)
      3) If products disappear, check DevTools -> Network:
         - If you see 404 for index.<hash>.js, React never runs.
    -->

    <!-- Helps relative links behave on Cloudflare Pages -->
    <base href="/" />

    <title>AI Affiliate</title>

    <!--
      ✅ Use ROOT-RELATIVE paths (start with /)
      Why? Because /index... always means "from the site root",
      which prevents weird path issues (like /something/index...).
      
      ⚠️ VERY IMPORTANT:
      The filename must match EXACTLY what exists in your GitHub repo.
      If you renamed or regenerated bundles, update the filename here.
    -->
    <script src="/index.DRTaNfeK.js" defer></script>

    <style>
      /* ====== Page baseline ====== */
      html,
      body {
        height: 100%;
        margin: 0;
      }

      body {
        /* Soft gradient so the spark effect feels “premium” */
        background: radial-gradient(
            1200px 800px at 20% 20%,
            rgba(120, 150, 255, 0.12),
            transparent 50%
          ),
          radial-gradient(
            1000px 700px at 80% 30%,
            rgba(255, 140, 200, 0.10),
            transparent 55%
          ),
          radial-gradient(
            900px 800px at 30% 80%,
            rgba(120, 255, 200, 0.10),
            transparent 60%
          ),
          #ffffff;
        overflow-x: hidden;
      }

      /* ====== Spark background layer ====== */
      #spark-canvas {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        z-index: 0;

        /* CRITICAL: canvas never blocks clicking/scrolling */
        pointer-events: none;
      }

      /* ====== App layer ====== */
      #root {
        position: relative;
        z-index: 1; /* App always above the canvas */
        min-height: 100%;
      }

      /* ====== Hint pill ====== */
      #spark-hint {
        position: fixed;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 2;
        font: 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        background: rgba(255, 255, 255, 0.85);
        border: 1px solid rgba(0, 0, 0, 0.08);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        padding: 8px 12px;
        border-radius: 999px;
        backdrop-filter: blur(8px);
        user-select: none;
        pointer-events: none;
        color: #222;
      }

      /* Accessibility: reduce motion */
      @media (prefers-reduced-motion: reduce) {
        #spark-hint {
          display: none;
        }
      }
    </style>
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <!-- Background canvas (non-blocking) -->
    <canvas id="spark-canvas" aria-hidden="true"></canvas>

    <!-- Tiny hint -->
    <div id="spark-hint">Move your mouse ✨ click to “spark” the background</div>

    <!-- React mounts here -->
    <div id="root"></div>

    <!-- Expo AppEntry bundle (also root-relative) -->
    <script src="/AppEntry-ff4ae59a90a1b1b6314d086b5393f432.js" defer></script>

    <script>
      /**
       * Spark Background (safe + non-blocking)
       * - Canvas is BEHIND the app (z-index 0)
       * - pointer-events:none so it can't break the UI
       * - requestAnimationFrame for smooth animation
       * - respects prefers-reduced-motion
       */
      (function () {
        const reduceMotion =
          window.matchMedia &&
          window.matchMedia("(prefers-reduced-motion: reduce)").matches;

        if (reduceMotion) {
          const hint = document.getElementById("spark-hint");
          if (hint) hint.remove();
          return;
        }

        const canvas = document.getElementById("spark-canvas");
        if (!canvas) return;

        const ctx = canvas.getContext("2d");
        if (!ctx) return;

        let w = 0,
          h = 0,
          dpr = 1;

        function resize() {
          dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
          w = Math.floor(window.innerWidth);
          h = Math.floor(window.innerHeight);
          canvas.width = Math.floor(w * dpr);
          canvas.height = Math.floor(h * dpr);
          canvas.style.width = w + "px";
          canvas.style.height = h + "px";
          ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        }

        window.addEventListener("resize", resize, { passive: true });
        resize();

        const particles = [];
        const MAX_PARTICLES = 260;

        const mouse = {
          x: w * 0.5,
          y: h * 0.4,
          vx: 0,
          vy: 0,
          lastX: w * 0.5,
          lastY: h * 0.4,
        };

        window.addEventListener(
          "mousemove",
          (e) => {
            const x = e.clientX;
            const y = e.clientY;

            mouse.vx = x - mouse.lastX;
            mouse.vy = y - mouse.lastY;

            mouse.lastX = x;
            mouse.lastY = y;

            mouse.x = x;
            mouse.y = y;

            spawn(x, y, 2, 0.8);
          },
          { passive: true }
        );

        window.addEventListener("click", (e) => {
          spawn(e.clientX, e.clientY, 28, 2.6);
        });

        function spawn(x, y, count, power) {
          for (let i = 0; i < count; i++) {
            if (particles.length >= MAX_PARTICLES) particles.shift();

            const angle = Math.random() * Math.PI * 2;
            const speed = (0.6 + Math.random() * 1.6) * power;

            particles.push({
              x,
              y,
              vx: Math.cos(angle) * speed + mouse.vx * 0.03,
              vy: Math.sin(angle) * speed + mouse.vy * 0.03,
              r: 1 + Math.random() * 3.5,
              life: 1,
              decay: 0.012 + Math.random() * 0.02,
              hue: 210 + Math.random() * 80,
            });
          }
        }

        function draw() {
          ctx.clearRect(0, 0, w, h);

          for (let i = particles.length - 1; i >= 0; i--) {
            const p = particles[i];
            p.x += p.vx;
            p.y += p.vy;
            p.vx *= 0.98;
            p.vy *= 0.98;

            p.life -= p.decay;
            if (p.life <= 0) {
              particles.splice(i, 1);
              continue;
            }

            const alpha = Math.max(0, Math.min(1, p.life));
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
            ctx.fillStyle = `hsla(${p.hue}, 85%, 65%, ${alpha * 0.9})`;
            ctx.fill();
          }

          requestAnimationFrame(draw);
        }

        draw();
      })();
    </script>
  </body>
</html>
